<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>图片尺寸显示功能测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }
        .test-section h3 {
            margin-top: 0;
            color: #333;
        }
        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }
        .image-item {
            text-align: center;
        }
        .image-item img {
            max-width: 100%;
            height: auto;
            border: 2px solid #ddd;
            border-radius: 4px;
            transition: transform 0.2s ease;
        }
        .image-item img:hover {
            transform: scale(1.02);
        }
        .image-info {
            margin-top: 8px;
            font-size: 12px;
            color: #666;
        }
        .instructions {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
        }
        .instructions h4 {
            margin-top: 0;
            color: #1976d2;
        }
        .instructions ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        .status {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #4caf50;
            color: white;
            padding: 10px 15px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div class="status">扩展已加载 ✓</div>
    
    <div class="container">
        <h1>图片尺寸显示功能测试</h1>
        
        <div class="instructions">
            <h4>测试说明：</h4>
            <ul>
                <li>将鼠标悬停在任意图片上，应该显示图片的像素尺寸（宽×高）</li>
                <li>尺寸提示框应该跟随鼠标移动</li>
                <li>鼠标离开图片时，提示框应该消失</li>
                <li>现有功能应该正常工作：绿色高亮边框、D键下载等</li>
                <li>按Ctrl+点击可以选择图片（蓝色边框）</li>
            </ul>
        </div>
        
        <div class="test-section">
            <h3>测试图片 - 不同尺寸</h3>
            <div class="image-grid">
                <div class="image-item">
                    <img src="https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?prompt=beautiful%20landscape%20mountain%20sunset%20golden%20hour&image_size=square" alt="方形图片">
                    <div class="image-info">方形图片 (应显示实际尺寸)</div>
                </div>
                <div class="image-item">
                    <img src="https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?prompt=modern%20city%20skyline%20night%20lights&image_size=landscape_16_9" alt="横向图片">
                    <div class="image-info">横向图片 16:9 (应显示实际尺寸)</div>
                </div>
                <div class="image-item">
                    <img src="https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?prompt=portrait%20of%20elegant%20woman%20professional%20photography&image_size=portrait_4_3" alt="纵向图片">
                    <div class="image-info">纵向图片 4:3 (应显示实际尺寸)</div>
                </div>
                <div class="image-item">
                    <img src="https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?prompt=abstract%20geometric%20pattern%20colorful%20design&image_size=square_hd" alt="高清方形">
                    <div class="image-info">高清方形 (应显示实际尺寸)</div>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h3>功能兼容性测试</h3>
            <div class="image-grid">
                <div class="image-item">
                    <img src="https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?prompt=cute%20cat%20sitting%20on%20windowsill%20sunlight&image_size=square" alt="测试图片1">
                    <div class="image-info">悬停显示尺寸 + 绿色高亮</div>
                </div>
                <div class="image-item">
                    <img src="https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?prompt=delicious%20food%20plate%20restaurant%20presentation&image_size=landscape_4_3" alt="测试图片2">
                    <div class="image-info">Ctrl+点击选择 + D键下载</div>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h3>边界情况测试</h3>
            <div class="image-grid">
                <div class="image-item">
                    <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjUwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxyZWN0IHdpZHRoPSIxMDAiIGhlaWdodD0iNTAiIGZpbGw9IiM0Y2FmNTAiLz48dGV4dCB4PSI1MCIgeT0iMzAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IndoaXRlIiBmb250LXNpemU9IjEyIj5TVkc8L3RleHQ+PC9zdmc+" alt="SVG图片">
                    <div class="image-info">SVG图片 (100×50)</div>
                </div>
                <div class="image-item">
                    <img src="https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?prompt=minimalist%20design%20simple%20shapes%20clean&image_size=portrait_16_9" alt="小图片">
                    <div class="image-info">纵向图片 16:9</div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // 检查扩展是否加载
        function checkExtensionStatus() {
            const statusEl = document.querySelector('.status');
            if (typeof chrome !== 'undefined' && chrome.runtime && chrome.runtime.id) {
                statusEl.textContent = '扩展已加载 ✓';
                statusEl.style.background = '#4caf50';
            } else {
                statusEl.textContent = '扩展未加载 ✗';
                statusEl.style.background = '#f44336';
            }
        }
        
        // 页面加载完成后检查状态
        document.addEventListener('DOMContentLoaded', checkExtensionStatus);
        
        // 定期检查扩展状态
        setInterval(checkExtensionStatus, 2000);
        
        // 添加调试信息
        console.log('测试页面已加载');
        console.log('Chrome对象:', typeof chrome);
        console.log('扩展ID:', chrome?.runtime?.id);
        
        // 监听图片加载事件
        document.querySelectorAll('img').forEach(img => {
            img.addEventListener('load', function() {
                console.log(`图片已加载: ${this.alt}, 尺寸: ${this.naturalWidth}×${this.naturalHeight}`);
            });
            
            img.addEventListener('error', function() {
                console.error(`图片加载失败: ${this.alt}`);
            });
        });
    </script>
</body>
</html>