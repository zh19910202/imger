<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AnnotateFlow Assistant - é‡æ„ç‰ˆæœ¬æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .header {
            text-align: center;
            color: #333;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .test-section {
            margin-bottom: 30px;
        }
        
        .test-section h3 {
            color: #4CAF50;
            border-left: 4px solid #4CAF50;
            padding-left: 10px;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 10px 0;
        }
        
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary {
            background-color: #4CAF50;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #45a049;
        }
        
        .btn-secondary {
            background-color: #2196F3;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #1976D2;
        }
        
        .btn-warning {
            background-color: #ff9800;
            color: white;
        }
        
        .btn-warning:hover {
            background-color: #f57c00;
        }
        
        .status-display {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .test-images {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 10px 0;
        }
        
        .test-images img {
            width: 150px;
            height: 100px;
            object-fit: cover;
            border: 2px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            transition: border-color 0.3s;
        }
        
        .test-images img:hover {
            border-color: #4CAF50;
        }
        
        .keyboard-shortcuts {
            background-color: #e3f2fd;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        
        .shortcut-item {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
        }
        
        .shortcut-key {
            background-color: #333;
            color: white;
            padding: 2px 8px;
            border-radius: 3px;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ AnnotateFlow Assistant v2.0</h1>
            <p>é‡æ„ç‰ˆæœ¬åŠŸèƒ½æµ‹è¯•é¡µé¢</p>
        </div>

        <!-- åº”ç”¨çŠ¶æ€ -->
        <div class="test-section">
            <h3>ğŸ“Š åº”ç”¨çŠ¶æ€</h3>
            <div class="button-group">
                <button class="btn-primary" onclick="checkAppStatus()">æ£€æŸ¥åº”ç”¨çŠ¶æ€</button>
                <button class="btn-secondary" onclick="getDebugInfo()">è·å–è°ƒè¯•ä¿¡æ¯</button>
                <button class="btn-warning" onclick="restartApp()">é‡å¯åº”ç”¨</button>
            </div>
            <div id="app-status" class="status-display">ç‚¹å‡»"æ£€æŸ¥åº”ç”¨çŠ¶æ€"æŸ¥çœ‹åº”ç”¨ä¿¡æ¯...</div>
        </div>

        <!-- é”®ç›˜å¿«æ·é”®æµ‹è¯• -->
        <div class="test-section">
            <h3>âŒ¨ï¸ é”®ç›˜å¿«æ·é”®</h3>
            <div class="keyboard-shortcuts">
                <div class="shortcut-item">
                    <span>ä¸‹è½½å›¾ç‰‡</span>
                    <span class="shortcut-key">D</span>
                </div>
                <div class="shortcut-item">
                    <span>è·³è¿‡æŒ‰é’®</span>
                    <span class="shortcut-key">Space</span>
                </div>
                <div class="shortcut-item">
                    <span>æäº¤ç»§ç»­</span>
                    <span class="shortcut-key">S</span>
                </div>
                <div class="shortcut-item">
                    <span>ä¸Šä¼ å›¾ç‰‡</span>
                    <span class="shortcut-key">A</span>
                </div>
                <div class="shortcut-item">
                    <span>è°ƒè¯•æ¨¡å¼</span>
                    <span class="shortcut-key">Z</span>
                </div>
            </div>
            <p><strong>è¯´æ˜:</strong> å°†ç„¦ç‚¹æ”¾åœ¨é¡µé¢ä¸Šï¼Œç„¶åæŒ‰ç›¸åº”çš„é”®æµ‹è¯•åŠŸèƒ½</p>
        </div>

        <!-- å›¾ç‰‡æµ‹è¯• -->
        <div class="test-section">
            <h3>ğŸ–¼ï¸ å›¾ç‰‡åŠŸèƒ½æµ‹è¯•</h3>
            <div class="button-group">
                <button class="btn-primary" onclick="testImageDetection()">æµ‹è¯•å›¾ç‰‡æ£€æµ‹</button>
                <button class="btn-secondary" onclick="downloadTestImage()">ä¸‹è½½æµ‹è¯•å›¾ç‰‡</button>
                <button class="btn-warning" onclick="getImageStats()">è·å–å›¾ç‰‡ç»Ÿè®¡</button>
            </div>
            <div class="test-images">
                <img src="https://picsum.photos/300/200?random=1" alt="æµ‹è¯•å›¾ç‰‡1" onclick="selectImage(this)">
                <img src="https://picsum.photos/300/200?random=2" alt="æµ‹è¯•å›¾ç‰‡2" onclick="selectImage(this)">
                <img src="https://picsum.photos/300/200?random=3" alt="æµ‹è¯•å›¾ç‰‡3" onclick="selectImage(this)">
            </div>
            <div id="image-status" class="status-display">ç‚¹å‡»å›¾ç‰‡æˆ–æµ‹è¯•æŒ‰é’®æŸ¥çœ‹ç»“æœ...</div>
        </div>

        <!-- é€šçŸ¥ç³»ç»Ÿæµ‹è¯• -->
        <div class="test-section">
            <h3>ğŸ”” é€šçŸ¥ç³»ç»Ÿæµ‹è¯•</h3>
            <div class="button-group">
                <button class="btn-primary" onclick="testNotifications('success')">æˆåŠŸé€šçŸ¥</button>
                <button class="btn-secondary" onclick="testNotifications('info')">ä¿¡æ¯é€šçŸ¥</button>
                <button class="btn-warning" onclick="testNotifications('warning')">è­¦å‘Šé€šçŸ¥</button>
                <button class="btn-warning" onclick="testNotifications('error')">é”™è¯¯é€šçŸ¥</button>
            </div>
        </div>

        <!-- ç½‘ç»œç›‘å¬æµ‹è¯• -->
        <div class="test-section">
            <h3>ğŸŒ ç½‘ç»œç›‘å¬æµ‹è¯•</h3>
            <div class="button-group">
                <button class="btn-primary" onclick="testNetworkRequest()">å‘èµ·æµ‹è¯•è¯·æ±‚</button>
                <button class="btn-secondary" onclick="getNetworkStats()">è·å–ç½‘ç»œç»Ÿè®¡</button>
                <button class="btn-warning" onclick="clearNetworkHistory()">æ¸…ç†è¯·æ±‚å†å²</button>
            </div>
            <div id="network-status" class="status-display">ç‚¹å‡»æŒ‰é’®æµ‹è¯•ç½‘ç»œç›‘å¬åŠŸèƒ½...</div>
        </div>

        <!-- æ¨¡æ€æ¡†æµ‹è¯• -->
        <div class="test-section">
            <h3>ğŸ“± æ¨¡æ€æ¡†æµ‹è¯•</h3>
            <div class="button-group">
                <button class="btn-primary" onclick="createTestModal()">åˆ›å»ºæµ‹è¯•æ¨¡æ€æ¡†</button>
                <button class="btn-secondary" onclick="closeAllModals()">å…³é—­æ‰€æœ‰æ¨¡æ€æ¡†</button>
            </div>
        </div>
    </div>

    <!-- åŠ è½½é‡æ„åçš„åº”ç”¨ -->
    <script type="module">
        // ç”±äºæµè§ˆå™¨çš„æ¨¡å—åŠ è½½é™åˆ¶ï¼Œè¿™é‡Œä½¿ç”¨ç®€åŒ–çš„æµ‹è¯•æ–¹å¼
        // å®é™…ä½¿ç”¨æ—¶éœ€è¦åœ¨æ”¯æŒES6æ¨¡å—çš„ç¯å¢ƒä¸­è¿è¡Œ
        
        // æ¨¡æ‹Ÿåº”ç”¨çŠ¶æ€
        window.testAppState = {
            initialized: false,
            version: '2.0.0',
            modules: {},
            selectedImage: null
        };

        // æµ‹è¯•å‡½æ•°
        window.checkAppStatus = function() {
            const status = document.getElementById('app-status');
            const appInfo = window.AnnotateFlowApp ? window.getAppInfo() : null;
            
            if (appInfo) {
                status.textContent = JSON.stringify(appInfo, null, 2);
                window.testAppState.initialized = true;
            } else {
                status.textContent = `åº”ç”¨çŠ¶æ€: æœªåˆå§‹åŒ–
ç‰ˆæœ¬: ${window.testAppState.version}
æ¨¡å—çŠ¶æ€: ç­‰å¾…åŠ è½½...

æ³¨æ„: è¿™æ˜¯æµ‹è¯•é¡µé¢ï¼Œå®é™…åº”ç”¨éœ€è¦åœ¨ç›®æ ‡ç½‘ç«™ä¸Šè¿è¡Œ`;
            }
        };

        window.getDebugInfo = function() {
            const status = document.getElementById('app-status');
            if (window.AnnotateFlowApp) {
                const debugInfo = window.getAppInfo();
                status.textContent = JSON.stringify(debugInfo, null, 2);
            } else {
                status.textContent = 'è°ƒè¯•ä¿¡æ¯: åº”ç”¨æœªåˆå§‹åŒ–\nè¯·åœ¨ç›®æ ‡ç½‘ç«™ä¸ŠåŠ è½½é‡æ„åçš„content.jsæ–‡ä»¶';
            }
        };

        window.restartApp = function() {
            if (window.AnnotateFlowApp && window.AnnotateFlowApp.restart) {
                window.AnnotateFlowApp.restart();
            } else {
                alert('é‡å¯åŠŸèƒ½éœ€è¦åœ¨å®é™…åº”ç”¨ç¯å¢ƒä¸­ä½¿ç”¨');
            }
        };

        window.testImageDetection = function() {
            const status = document.getElementById('image-status');
            const images = document.querySelectorAll('.test-images img');
            
            status.textContent = `æ£€æµ‹åˆ° ${images.length} å¼ æµ‹è¯•å›¾ç‰‡:
${Array.from(images).map((img, i) => `${i+1}. ${img.src}`).join('\n')}

åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒImageDetectorä¼šè‡ªåŠ¨æ£€æµ‹é¡µé¢ä¸­çš„æ‰€æœ‰å›¾ç‰‡`;
        };

        window.selectImage = function(img) {
            // ç§»é™¤å…¶ä»–å›¾ç‰‡çš„é€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.test-images img').forEach(i => {
                i.style.borderColor = '#ddd';
            });
            
            // é€‰ä¸­å½“å‰å›¾ç‰‡
            img.style.borderColor = '#4CAF50';
            window.testAppState.selectedImage = img;
            
            const status = document.getElementById('image-status');
            status.textContent = `å·²é€‰ä¸­å›¾ç‰‡: ${img.src}
å°ºå¯¸: ${img.naturalWidth || img.width} x ${img.naturalHeight || img.height}

åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒæŒ‰Dé”®å¯ä»¥ä¸‹è½½é€‰ä¸­çš„å›¾ç‰‡`;
        };

        window.downloadTestImage = function() {
            if (window.testAppState.selectedImage) {
                // æ¨¡æ‹Ÿä¸‹è½½
                const img = window.testAppState.selectedImage;
                const link = document.createElement('a');
                link.href = img.src;
                link.download = `test-image-${Date.now()}.jpg`;
                link.click();
                
                alert('æµ‹è¯•å›¾ç‰‡ä¸‹è½½å·²è§¦å‘');
            } else {
                alert('è¯·å…ˆé€‰æ‹©ä¸€å¼ å›¾ç‰‡');
            }
        };

        window.getImageStats = function() {
            const status = document.getElementById('image-status');
            const images = document.querySelectorAll('img');
            
            status.textContent = `å›¾ç‰‡ç»Ÿè®¡ä¿¡æ¯:
æ€»å›¾ç‰‡æ•°: ${images.length}
é€‰ä¸­å›¾ç‰‡: ${window.testAppState.selectedImage ? 'æ˜¯' : 'å¦'}
æœ€å¤§å›¾ç‰‡: ${Math.max(...Array.from(images).map(img => (img.naturalWidth || img.width) * (img.naturalHeight || img.height)))} åƒç´ 

åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒImageDetectorä¼šæä¾›æ›´è¯¦ç»†çš„ç»Ÿè®¡ä¿¡æ¯`;
        };

        window.testNotifications = function(type) {
            const messages = {
                success: 'è¿™æ˜¯ä¸€ä¸ªæˆåŠŸé€šçŸ¥ï¼',
                info: 'è¿™æ˜¯ä¸€ä¸ªä¿¡æ¯é€šçŸ¥ï¼',
                warning: 'è¿™æ˜¯ä¸€ä¸ªè­¦å‘Šé€šçŸ¥ï¼',
                error: 'è¿™æ˜¯ä¸€ä¸ªé”™è¯¯é€šçŸ¥ï¼'
            };
            
            if (window.showNotification) {
                window.showNotification(messages[type]);
            } else {
                // æ¨¡æ‹Ÿé€šçŸ¥
                const notification = document.createElement('div');
                notification.textContent = messages[type];
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 12px 20px;
                    border-radius: 4px;
                    color: white;
                    z-index: 10000;
                    background-color: ${type === 'success' ? '#4CAF50' : type === 'info' ? '#2196F3' : type === 'warning' ? '#ff9800' : '#f44336'};
                `;
                
                document.body.appendChild(notification);
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 3000);
            }
        };

        window.testNetworkRequest = function() {
            const status = document.getElementById('network-status');
            
            // å‘èµ·æµ‹è¯•è¯·æ±‚
            fetch('https://jsonplaceholder.typicode.com/posts/1')
                .then(response => response.json())
                .then(data => {
                    status.textContent = `æµ‹è¯•è¯·æ±‚æˆåŠŸ:
URL: https://jsonplaceholder.typicode.com/posts/1
çŠ¶æ€: 200 OK
å“åº”: ${JSON.stringify(data, null, 2)}

åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒNetworkMonitorä¼šè‡ªåŠ¨ç›‘å¬æ‰€æœ‰ç½‘ç»œè¯·æ±‚`;
                })
                .catch(error => {
                    status.textContent = `æµ‹è¯•è¯·æ±‚å¤±è´¥: ${error.message}`;
                });
        };

        window.getNetworkStats = function() {
            const status = document.getElementById('network-status');
            status.textContent = `ç½‘ç»œç»Ÿè®¡ä¿¡æ¯ (æ¨¡æ‹Ÿ):
æ€»è¯·æ±‚æ•°: 5
æˆåŠŸè¯·æ±‚: 4
å¤±è´¥è¯·æ±‚: 1
å¹³å‡å“åº”æ—¶é—´: 245ms
æˆåŠŸç‡: 80%

åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒNetworkMonitorä¼šæä¾›çœŸå®çš„ç½‘ç»œç»Ÿè®¡æ•°æ®`;
        };

        window.clearNetworkHistory = function() {
            const status = document.getElementById('network-status');
            status.textContent = 'ç½‘ç»œè¯·æ±‚å†å²å·²æ¸…ç†';
        };

        window.createTestModal = function() {
            const modal = document.createElement('div');
            modal.innerHTML = `
                <h3>æµ‹è¯•æ¨¡æ€æ¡†</h3>
                <p>è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ¨¡æ€æ¡†ï¼Œç”¨äºéªŒè¯ModalManageråŠŸèƒ½ã€‚</p>
                <p>åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒæŒ‰ESCé”®æˆ–ç‚¹å‡»å…³é—­æŒ‰é’®å¯ä»¥å…³é—­æ¨¡æ€æ¡†ã€‚</p>
                <button onclick="closeTestModal(this)">å…³é—­</button>
            `;
            
            modal.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: white;
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.3);
                z-index: 10000;
                max-width: 400px;
            `;
            
            const backdrop = document.createElement('div');
            backdrop.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.5);
                z-index: 9999;
            `;
            
            backdrop.onclick = () => {
                document.body.removeChild(backdrop);
                document.body.removeChild(modal);
            };
            
            document.body.appendChild(backdrop);
            document.body.appendChild(modal);
            
            window.closeTestModal = function(btn) {
                const modal = btn.closest('div');
                const backdrop = document.querySelector('div[style*="rgba(0,0,0,0.5)"]');
                if (backdrop) document.body.removeChild(backdrop);
                if (modal) document.body.removeChild(modal);
            };
        };

        window.closeAllModals = function() {
            const modals = document.querySelectorAll('div[style*="z-index: 10000"]');
            const backdrops = document.querySelectorAll('div[style*="rgba(0,0,0,0.5)"]');
            
            modals.forEach(modal => {
                if (modal.parentNode) modal.parentNode.removeChild(modal);
            });
            
            backdrops.forEach(backdrop => {
                if (backdrop.parentNode) backdrop.parentNode.removeChild(backdrop);
            });
            
            alert('æ‰€æœ‰æ¨¡æ€æ¡†å·²å…³é—­');
        };

        // é”®ç›˜äº‹ä»¶ç›‘å¬
        document.addEventListener('keydown', function(event) {
            if (event.target.tagName === 'INPUT' || event.target.tagName === 'TEXTAREA') {
                return;
            }
            
            const key = event.key.toLowerCase();
            
            switch(key) {
                case 'd':
                    event.preventDefault();
                    if (window.testAppState.selectedImage) {
                        window.downloadTestImage();
                    } else {
                        alert('è¯·å…ˆé€‰æ‹©ä¸€å¼ å›¾ç‰‡ï¼Œç„¶åæŒ‰Dé”®ä¸‹è½½');
                    }
                    break;
                case ' ':
                    event.preventDefault();
                    alert('ç©ºæ ¼é”®è¢«æŒ‰ä¸‹ - åœ¨å®é™…åº”ç”¨ä¸­ä¼šç‚¹å‡»è·³è¿‡æŒ‰é’®');
                    break;
                case 's':
                    event.preventDefault();
                    alert('Sé”®è¢«æŒ‰ä¸‹ - åœ¨å®é™…åº”ç”¨ä¸­ä¼šç‚¹å‡»æäº¤æŒ‰é’®');
                    break;
                case 'a':
                    event.preventDefault();
                    alert('Aé”®è¢«æŒ‰ä¸‹ - åœ¨å®é™…åº”ç”¨ä¸­ä¼šæ‰“å¼€æ–‡ä»¶é€‰æ‹©å™¨');
                    break;
                case 'z':
                    event.preventDefault();
                    alert('Zé”®è¢«æŒ‰ä¸‹ - è°ƒè¯•æ¨¡å¼åˆ‡æ¢');
                    break;
            }
        });

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('AnnotateFlow Assistant æµ‹è¯•é¡µé¢å·²åŠ è½½');
            window.checkAppStatus();
        });
    </script>
</body>
</html>