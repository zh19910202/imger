# AnnotateFlow Assistant - Chrome扩展

一个专为腾讯QLabel标注平台设计的Chrome扩展，提供图片快捷下载和标注操作快捷键功能。

## 功能特性

- 🖼️ **保留原始格式和尺寸** - 下载的图片完全保持原样
- ⚡ **多种快捷下载方式** - 右键菜单、双击、悬停+D键
- 🔄 **智能打开控制** - 可选择是否尝试打开下载的文件
- 🎯 **智能识别** - 自动检测页面中的所有图片
- 💾 **批量支持** - 支持下载多个图片
- 🎨 **美观界面** - 现代化的弹出窗口设计
- 📁 **智能下载路径** - 图片自动保存到浏览器默认下载文件夹
- ⚙️ **个性化设置** - 保存用户偏好设置
- 🔊 **音效反馈** - S键提交时播放到账音效（可开关）
- 🖼️ **自动打开** - 下载完成后自动使用默认图片查看器打开（可开关）

## 快捷下载方式

### 1. 右键菜单下载
- 右键点击任意图片
- 选择"快捷下载图片"
- 图片自动下载并尝试打开

### 2. 双击快速下载
- 双击任意图片
- 立即开始下载
- 下载完成后尝试打开

### 3. 悬停+D键下载 ⭐ **新功能**
- 将鼠标悬停在图片上
- 同时按下D键（不区分大小写）
- 超快速下载，带视觉反馈

### 4. 按钮快捷键操作
- **空格键** - 点击页面中的"跳过"按钮
- **S键** - 点击页面中的"提交"或"提交并继续标注"按钮（播放到账音效）
- **A键** - 点击页面中的"上传图片"按钮
- **F键** - 点击页面中的"查看历史"链接

## 安装方法

### 方法1：开发者模式安装（推荐）

1. 下载或克隆此项目到本地
2. 打开Chrome浏览器，进入 `chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择项目文件夹
6. 扩展安装完成！

### 方法2：打包安装

1. 在 `chrome://extensions/` 页面点击"打包扩展程序"
2. 选择项目根目录
3. 生成 `.crx` 文件后拖拽安装

## 使用方法

### 支持平台
- 本扩展专为 [腾讯QLabel标注平台](https://qlabel.tencent.com/) 设计
- 只在 `https://qlabel.tencent.com/` 网站上运行

### 基本操作
1. 在QLabel标注平台上找到想要下载的图片
2. 使用以下任一方式下载：
   - 右键 → "快捷下载图片"
   - 双击图片
   - 悬停图片 + 按D键
3. 图片将自动下载到桌面ImageDownloader文件夹
4. 根据设置决定是否自动打开文件

### 快捷键操作
- **D键** - 下载当前悬停的图片
- **空格键** - 快速跳过当前标注任务
- **S键** - 快速提交并继续标注（带音效反馈）
- **A键** - 快速上传图片
- **F键** - 快速查看历史记录

### 设置说明
1. 点击扩展图标打开设置面板
2. **下载路径**：
   - 使用浏览器默认下载文件夹
   - 无需手动设置路径
3. **自动打开设置**：
   - 勾选：下载完成后自动使用默认图片查看器打开
   - 取消：仅下载，不自动打开
4. **音效设置**：
   - 勾选：S键提交时播放音效
   - 取消：关闭音效反馈

### 悬停+D键操作详解
1. 将鼠标移动到图片上方（保持悬停状态）
2. 按下键盘上的D键（大写或小写都可以）
3. 会看到绿色的"开始下载..."提示
4. 图片开始下载，提示会在2秒后自动消失

### 音效设置
为了让S键按下时播放到账音效，请参考 `SOUND_SETUP.md` 文件：
1. 准备一个MP3格式的音效文件
2. 重命名为 `notification.mp3`
3. 放置在项目根目录
4. 重新加载扩展即可生效

### 音效开关
- 点击扩展图标打开设置面板
- 在"设置"部分找到"S键音效"开关
- 可以随时开启或关闭音效功能
- 设置会自动保存并同步到所有标签页

## 文件结构

```
├── manifest.json          # 扩展配置文件
├── background.js          # 后台脚本
├── content.js            # 内容脚本（包含悬停+D键功能和音效）
├── popup.html            # 弹出窗口
├── notification.mp3      # 音效文件（需要用户添加）
├── SOUND_SETUP.md        # 音效设置说明
├── package.json          # 项目配置
└── README.md             # 说明文档
```

## 注意事项

- 确保浏览器有足够的权限访问下载文件夹
- 某些网站可能限制图片下载，这是正常现象
- 悬停+D键功能需要图片处于悬停状态
- 下载提示会自动消失，无需手动关闭

## ⚠️ 技术限制说明

### 关于"自动打开"功能
由于Chrome扩展的安全限制，扩展无法直接控制系统的图片查看器。当启用"自动打开"选项时：

1. **扩展会尝试**：使用 `chrome.downloads.open()` API 请求系统打开文件
2. **系统响应**：如果系统支持，会使用默认应用打开文件
3. **可能的情况**：
   - ✅ 成功：系统使用默认图片查看器打开文件
   - ❌ 失败：系统拒绝请求，用户需要手动打开文件
   - ⚠️ 部分支持：某些系统可能有限制

### 为什么有这个限制？
- **安全考虑**：防止恶意扩展随意打开系统文件
- **权限控制**：扩展只能访问有限的系统资源
- **用户隐私**：保护用户的文件系统安全

### 替代方案
如果自动打开不工作，用户可以：
- 在下载文件夹中手动双击图片
- 使用系统文件管理器打开
- 配置系统默认图片查看器

## 技术实现

- **Manifest V3** - 使用最新的Chrome扩展标准
- **Service Worker** - 后台处理下载逻辑
- **Context Menus API** - 右键菜单集成
- **Downloads API** - 文件下载管理
- **Content Scripts** - 页面内容交互
- **Keyboard Events** - 键盘事件监听
- **Mouse Events** - 鼠标悬停检测

## 更新日志

### v2.2.0
- 新增图片下载完成后自动打开功能
- 优化下载路径管理，使用浏览器默认文件夹
- 改进设置界面，添加自动打开开关
- 增强用户体验和操作便利性

### v2.1.0
- 新增A键上传图片功能
- 新增F键查看历史功能
- 优化链接查找和点击逻辑
- 增强用户界面反馈效果

### v2.0.0
- 新增S键提交功能，带音效反馈
- 新增空格键跳过功能
- 新增音效开关功能，用户可自由控制
- 优化用户界面和交互体验
- 添加音效设置说明文档

### v1.0.0
- 初始版本发布
- 支持右键菜单下载
- 支持双击快速下载
- 支持悬停+D键超快速下载 ⭐
- 自动打开下载完成的图片
- 美观的下载提示动画

## 许可证

MIT License

## 贡献

欢迎提交Issue和Pull Request来改进这个扩展！
